import{b as Rt,g as ei}from"./index-0L8iWxnJ.js";import{r as se}from"./___vite-browser-external_commonjs-proxy-CrdbQfvh.js";function ti(c,T){for(var I=0;I<T.length;I++){const t=T[I];if(typeof t!="string"&&!Array.isArray(t)){for(const _ in t)if(_!=="default"&&!(_ in c)){const w=Object.getOwnPropertyDescriptor(t,_);w&&Object.defineProperty(c,_,w.get?w:{enumerable:!0,get:()=>t[_]})}}}return Object.freeze(Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}))}var Oe,lt;function ii(){if(lt)return Oe;lt=1;const c=Buffer.from("D0CF11E0A1B11AE1","hex");class T{constructor(){}load(t){for(let _=0;_<c.length;_++)if(c[_]!=t[_])return!1;this.secSize=1<<t.readInt16LE(30),this.shortSecSize=1<<t.readInt16LE(32),this.SATSize=t.readInt32LE(44),this.dirSecId=t.readInt32LE(48),this.shortStreamMax=t.readInt32LE(56),this.SSATSecId=t.readInt32LE(60),this.SSATSize=t.readInt32LE(64),this.MSATSecId=t.readInt32LE(68),this.MSATSize=t.readInt32LE(72),this.partialMSAT=new Array(109);for(let _=0;_<109;_++)this.partialMSAT[_]=t.readInt32LE(76+_*4);return!0}}return Oe=T,Oe}var Pe,dt;function si(){if(dt)return Pe;dt=1;const c=-1;class T{constructor(t){this._doc=t}load(t){const _=this._doc,w=_._header;return this._table=new Array(t.length*(w.secSize/4)),_._readSectors(t).then(p=>{for(let C=0;C<p.length/4;C++)this._table[C]=p.readInt32LE(C*4)})}getSecIdChain(t){let _=t;const w=[];for(;_>c;){w.push(_);const p=_;if(_=this._table[_],_===p)break}return w}}return Pe=T,Pe}var Me,ft;function ri(){if(ft)return Me;ft=1;const c=1,T=2,I=5,t=-1;class _{constructor(p){this._doc=p}load(p){return this._doc._readSectors(p).then(D=>{const i=D.length/128;this._entries=new Array(i);for(let y=0;y<i;y++){const r=y*128,B=Math.max(D.readInt16LE(64+r)-1,0),P={};P.name=D.toString("utf16le",0+r,B+r),P.type=D.readInt8(66+r),P.nodeColor=D.readInt8(67+r),P.left=D.readInt32LE(68+r),P.right=D.readInt32LE(72+r),P.storageDirId=D.readInt32LE(76+r),P.secId=D.readInt32LE(116+r),P.size=D.readInt32LE(120+r),this._entries[y]=P}this.root=this._entries.find(y=>y.type===I),this._buildHierarchy(this.root)})}_buildHierarchy(p){const C=this._getChildIds(p);p.storages={},p.streams={};for(const D of C){const i=this._entries[D],y=i.name;i.type===c&&(p.storages[y]=i),i.type===T&&(p.streams[y]=i)}for(const D in p.storages)this._buildHierarchy(p.storages[D])}_getChildIds(p){const C=[],D=i=>{i.left!==t&&(C.push(i.left),D(this._entries[i.left])),i.right!==t&&(C.push(i.right),D(this._entries[i.right]))};if(p.storageDirId>-1){C.push(p.storageDirId);const i=this._entries[p.storageDirId];D(i)}return C}}return Me=_,Me}var Be,ut;function ni(){if(ut)return Be;ut=1;const{Readable:c}=se;class T extends c{constructor(t,_){super(),this._doc=t,this._streamEntry=_,this.initialize()}initialize(){if(this._index=0,this._done=!0,!this._streamEntry)return;const t=this._doc;this._bytes=this._streamEntry.size,this._allocationTable=t._SAT,this._shortStream=!1,this._bytes<t._header.shortStreamMax&&(this._shortStream=!0,this._allocationTable=t._SSAT),this._secIds=this._allocationTable.getSecIdChain(this._streamEntry.secId),this._done=!1}_readSector(t){return this._shortStream?this._doc._readShortSector(t):this._doc._readSector(t)}_read(){return this._done?this.push(null):this._index>=this._secIds.length?(this._done=!0,this.push(null)):this._readSector(this._secIds[this._index]).then(t=>{this._bytes-t.length<0&&(t=t.slice(0,this._bytes)),this._bytes-=t.length,this._index++,this.push(t)})}}return Be=T,Be}var Ue,xt;function ai(){if(xt)return Ue;xt=1;const c=ni();class T{constructor(t,_){this._doc=t,this._dirEntry=_}storage(t){return new T(this._doc,this._dirEntry.storages[t])}stream(t){return new c(this._doc,this._dirEntry.streams[t])}}return Ue=T,Ue}var He,mt;function oi(){if(mt)return He;mt=1;const c=ii(),T=si(),I=ri(),t=ai();class _{constructor(p){this._reader=p,this._skipBytes=0}read(){return Promise.resolve().then(()=>this._readHeader()).then(()=>this._readMSAT()).then(()=>this._readSAT()).then(()=>this._readSSAT()).then(()=>this._readDirectoryTree()).then(()=>{if(this._skipBytes!=0)return this._readCustomHeader()}).then(()=>this)}_readCustomHeader(){const p=Buffer.alloc(this._skipBytes);return this._reader.read(p,0,this._skipBytes,0).then(C=>{this._customHeaderCallback(C)})}_readHeader(){const p=Buffer.alloc(512);return this._reader.read(p,0,512,0+this._skipBytes).then(C=>{if(!(this._header=new c).load(C))throw new Error("Not a valid compound document")})}_readMSAT(){const p=this._header;if(this._MSAT=p.partialMSAT.slice(0),this._MSAT.length=p.SATSize,p.SATSize<=109||p.MSATSize==0)return Promise.resolve();let C=109,D=0;const i=(y,r,B)=>y>=p.MSATSize?Promise.resolve():this._readSector(B).then(P=>{let b;for(b=0;b<p.secSize-4&&!(r>=p.SATSize);b+=4)this._MSAT[r]=P.readInt32LE(b),r++;return B=P.readInt32LE(p.secSize-4),i(y+1,r,B)});return i(D,C,p.MSATSecId)}_readSector(p){return this._readSectors([p])}_readSectors(p){const C=this._header,D=Buffer.alloc(p.length*C.secSize),i=y=>{if(y>=p.length)return Promise.resolve(D);const r=y*C.secSize,B=this._getFileOffsetForSec(p[y]);return this._reader.read(D,r,C.secSize,B).then(()=>i(y+1))};return i(0)}_readShortSector(p){return this._readShortSectors([p])}_readShortSectors(p){const C=this._header,D=Buffer.alloc(p.length*C.shortSecSize),i=y=>{if(y>=p.length)return Promise.resolve(D);const r=y*C.shortSecSize,B=this._getFileOffsetForShortSec(p[y]);return this._reader.read(D,r,C.shortSecSize,B).then(()=>i(y+1))};return i(0)}_readSAT(){return this._SAT=new T(this),this._SAT.load(this._MSAT)}_readSSAT(){const p=this._header,C=this._SAT.getSecIdChain(p.SSATSecId);return C.length!=p.SSATSize?Promise.reject(new Error("Invalid Short Sector Allocation Table")):(this._SSAT=new T(this),this._SSAT.load(C))}_readDirectoryTree(){const p=this._header;this._directoryTree=new I(this);const C=this._SAT.getSecIdChain(p.dirSecId);return this._directoryTree.load(C).then(()=>{const D=this._directoryTree.root;this._rootStorage=new t(this,D),this._shortStreamSecIds=this._SAT.getSecIdChain(D.secId)})}_getFileOffsetForSec(p){const C=this._header.secSize;return this._skipBytes+(p+1)*C}_getFileOffsetForShortSec(p){const C=this._header.shortSecSize,D=p*C,i=this._header.secSize,y=Math.floor(D/i),r=D%i,B=this._shortStreamSecIds[y];return this._getFileOffsetForSec(B)+r}storage(p){return this._rootStorage.storage(p)}stream(p){return this._rootStorage.stream(p)}}return He=_,He}var ve={},pt;function Nt(){if(pt)return ve;pt=1;const c=[];c[2]="\0",c[5]="\0",c[7]="	",c[8]="\0",c[10]=`
`,c[11]=`
`,c[12]=`
`,c[13]=`
`,c[30]="‑";const T=[];T[130]="‚",T[131]="ƒ",T[132]="„",T[133]="…",T[134]="†",T[135]="‡",T[136]="ˆ",T[137]="‰",T[138]="Š",T[139]="‹",T[140]="Œ",T[142]="Ž",T[145]="‘",T[146]="’",T[147]="“",T[148]="”",T[149]="•",T[150]="–",T[151]="—",T[152]="˜",T[153]="™",T[154]="š",T[155]="›",T[156]="œ",T[158]="ž",T[159]="Ÿ",ve.binaryToUnicode=t=>t.replace(/([\x80-\x9f])/g,_=>T[_.charCodeAt(0)]),ve.clean=t=>{t=t.replace(/([\x02\x05\x07\x08\x0a\x0b\x0c\x0d\x1f])/g,w=>c[w.charCodeAt(0)]);let _=!0;for(;_;)_=!1,t=t.replace(/(?:\x13[^\x13\x14\x15]*\x14?([^\x13\x14\x15]*)\x15)/g,(w,p)=>(_=!0,p));return t.replace(/[\x00-\x07]/g,"")};const I=[];return I[8194]=" ",I[8195]=" ",I[8210]="-",I[8211]="-",I[8212]="-",I[8216]="'",I[8217]="'",I[8220]='"',I[8221]='"',ve.filter=t=>t.replace(/[\u2002\u2003\u2012\u2013\u2014\u2018\u2019\u201c\u201d]/g,_=>I[_.charCodeAt(0)]),ve}var ke,_t;function Ot(){if(_t)return ke;_t=1;const{filter:c}=Nt();class T{constructor(){this._body="",this._footnotes="",this._endnotes="",this._headers="",this._footers="",this._annotations="",this._textboxes="",this._headerTextboxes=""}getBody(t){t=t||{};const _=this._body;return t.filterUnicode==!1?_:c(_)}getFootnotes(t){t=t||{};const _=this._footnotes;return t.filterUnicode==!1?_:c(_)}getEndnotes(t){t=t||{};const _=this._endnotes;return t.filterUnicode==!1?_:c(_)}getHeaders(t){t=t||{};const _=this._headers+(t.includeFooters==!1?"":this._footers);return t.filterUnicode==!1?_:c(_)}getFooters(t){t=t||{};const _=this._footers;return t.filterUnicode==!1?_:c(_)}getAnnotations(t){t=t||{};const _=this._annotations;return t.filterUnicode==!1?_:c(_)}getTextboxes(t){t=t||{};const _=[];t.includeBody!=!1&&_.push(this._textboxes),t.includeHeadersAndFooters!=!1&&_.push(this._headerTextboxes);const w=_.join(`
`);return t.filterUnicode==!1?w:c(w)}}return ke=T,ke}var ze,Et;function ci(){if(Et)return ze;Et=1;const c=oi(),T=Ot(),{binaryToUnicode:I,clean:t}=Nt(),_=0,w=(u,l)=>{for(let h=0;h<u.length;h++){const E=u[h];if(l<=E.endCp)return h}},p=(u,l)=>{for(let h=0;h<u.length;h++){const E=u[h];if(l<=E.endFilePos)return h}};function C(u,l,h){const E=w(u,l),g=w(u,h),d=[];for(let a=E,m=g;a<=m;a++){const S=u[a],F=a===E?l-S.startCp:0,O=a===g?h-S.startCp:S.endCp;d.push(S.text.substring(F,O))}return d.join("")}function D(u,l,h,E){const g=u.startCp,d=g+u.length,a=u.text;l<g&&(l=g),h>d&&(h=d);const m=(l==g?"":a.slice(0,l-g))+"".padStart(h-l,E)+(h==d?"":a.slice(h-d));u.text=m}function i(u,l,h,E){const g=u.startFilePos,d=g+u.size,a=u.text;l<g&&(l=g),h>d&&(h=d);const m=(l==g?"":a.slice(0,(l-g)/u.bpc))+"".padStart((h-l)/u.bpc,E)+(h==d?"":a.slice((h-d)/u.bpc));u.text=m}function y(u,l,h,E){const g=w(u,l),d=w(u,h);for(let a=g,m=d;a<=m;a++){const S=u[a];D(S,l,h,E)}}function r(u,l,h,E){const g=p(u,l),d=p(u,h);for(let a=g,m=d;a<=m;a++){const S=u[a];i(S,l,h,E)}}function B(u,l,h){r(u,l,h,"\0")}const P=(u,l,h)=>{for(;l<u.length-1;){const E=u.readUInt16LE(l),g=E&31,d=E>>9&1,a=E>>10&7,m=E>>13&7;if(l+=2,h(u,l,E,g,d,a,m),m===0){l+=1;continue}else if(m===1){l+=1;continue}else if(m===2){l+=2;continue}else if(m===3){l+=4;continue}else if(m===4||m===5){l+=2;continue}else if(m===6){l+=u.readUInt8(l)+1;continue}else if(m===7){l+=3;continue}else throw new Error("Unparsed sprm")}};class b{constructor(){this._pieces=[],this._bookmarks={},this._boundaries={},this._taggedHeaders=[]}extract(l){const h=new c(l);return h.read().then(()=>this.documentStream(h,"WordDocument").then(E=>this.streamBuffer(E)).then(E=>this.extractWordDocument(h,E)))}buildDocument(){const l=new T,h=this._pieces;let E=0;return l._body=t(C(h,E,E+this._boundaries.ccpText)),E+=this._boundaries.ccpText,this._boundaries.ccpFtn&&(l._footnotes=t(C(h,E,E+this._boundaries.ccpFtn-1)),E+=this._boundaries.ccpFtn),this._boundaries.ccpHdd&&(l._headers=t(this._taggedHeaders.filter(g=>g.type==="headers").map(g=>g.text).join("")),l._footers=t(this._taggedHeaders.filter(g=>g.type==="footers").map(g=>g.text).join("")),E+=this._boundaries.ccpHdd),this._boundaries.ccpAtn&&(l._annotations=t(C(h,E,E+this._boundaries.ccpAtn-1)),E+=this._boundaries.ccpAtn),this._boundaries.ccpEdn&&(l._endnotes=t(C(h,E,E+this._boundaries.ccpEdn-1)),E+=this._boundaries.ccpEdn),this._boundaries.ccpTxbx&&(l._textboxes=t(C(h,E,E+this._boundaries.ccpTxbx-1)),E+=this._boundaries.ccpTxbx),this._boundaries.ccpHdrTxbx&&(l._headerTextboxes=t(C(h,E,E+this._boundaries.ccpHdrTxbx-1)),E+=this._boundaries.ccpHdrTxbx),l}extractWordDocument(l,h){const E=h.readUInt16LE(0);if(E!==42476)return Promise.reject(new Error(`This does not seem to be a Word document: Invalid magic number: ${E.toString(16)}`));const d=h.readUInt16LE(10)&512?"1Table":"0Table";return this.documentStream(l,d).then(a=>this.streamBuffer(a)).then(a=>(this._boundaries.fcMin=h.readUInt32LE(24),this._boundaries.ccpText=h.readUInt32LE(76),this._boundaries.ccpFtn=h.readUInt32LE(80),this._boundaries.ccpHdd=h.readUInt32LE(84),this._boundaries.ccpAtn=h.readUInt32LE(92),this._boundaries.ccpEdn=h.readUInt32LE(96),this._boundaries.ccpTxbx=h.readUInt32LE(100),this._boundaries.ccpHdrTxbx=h.readUInt32LE(104),this.writeBookmarks(h,a),this.writePieces(h,a),this.writeCharacterProperties(h,a),this.writeParagraphProperties(h,a),this.normalizeHeaders(h,a),this.buildDocument()))}documentStream(l,h){return Promise.resolve(l.stream(h))}streamBuffer(l){return new Promise((h,E)=>{const g=[];return l.on("data",d=>g.push(d)),l.on("error",d=>E(d)),l.on("end",()=>h(Buffer.concat(g))),l})}writeFields(l,h,E){const g=l.readInt32LE(282),d=l.readUInt32LE(286);if(d==0)return;const a=(d-4)/6,m=(a+1)*4,S=h.slice(g,g+d);for(let F=0;F<a;F++)S.readUInt32LE(F*4),S.readUInt16LE(m+F*2)}writeBookmarks(l,h){const E=l.readUInt32LE(322),g=l.readUInt32LE(326),d=l.readUInt32LE(330),a=l.readUInt32LE(334),m=l.readUInt32LE(338),S=l.readUInt32LE(342);if(g===0)return;const F=h.slice(E,E+g),O=h.slice(d,d+a),L=h.slice(m,m+S),M=F.readUInt16LE(0);if(F.readUInt16LE(2),F.readUInt16LE(4),M!==65535)throw new Error("Internal error: unexpected single-byte bookmark data");let s=6;const n=0;for(;s<g;){let v=F.readUInt16LE(s);v=v*2;const x=F.slice(s+2,s+2+v),A=O.readUInt32LE(n*4),N=L.readUInt32LE(n*4);this._bookmarks[x]={start:A,end:N},s=s+v+2}}writePieces(l,h){let E,g=l.readUInt32LE(418);for(;E=h.readUInt8(g),E===1;){g=g+1;const F=h.readUInt16LE(g);g=g+2+F}if(E=h.readUInt8(g),g=g+1,E!==2)throw new Error("Internal error: ccorrupted Word file");const d=h.readUInt32LE(g);g=g+4;const a=(d-4)/12;let m=0,S=0;for(let F=0,O=a-1;F<=O;F++){const L=g+(a+1)*4+F*8+2;let M=h.readUInt32LE(L),s=!1;M&1073741824?(M=M&-1073741825,M=Math.floor(M/2)):s=!0;const n=h.readUInt32LE(g+F*4),v=h.readUInt32LE(g+(F+1)*4),x=v-n,A={startCp:m,startStream:S,totLength:x,startFilePos:M,unicode:s,bpc:s?2:1};A.size=A.bpc*(v-n);const N=l.slice(M,M+A.size);s?A.text=N.toString("ucs2"):A.text=I(N.toString("binary")),A.length=A.text.length,A.endCp=A.startCp+A.length,A.endStream=A.startStream+A.size,A.endFilePos=A.startFilePos+A.size,m=A.endCp,S=A.endStream,this._pieces.push(A)}}normalizeHeaders(l,h){const E=this._pieces,g=l.readUInt32LE(242),d=l.readUInt32LE(246);if(d<8)return;const a=this._boundaries.ccpText+this._boundaries.ccpFtn,m=this._boundaries.ccpHdd,S=h.slice(g,g+d),F=d/4;let O=a+S.readUInt32LE(0);for(let L=1;L<F;L++){let M=a+S.readUInt32LE(L*4);M>a+m&&(M=a+m);const s=C(E,O,M),n=L-1;[0,1,2].includes(n)?this._taggedHeaders.push({type:"footnoteSeparators",text:s}):[3,4,5].includes(n)?this._taggedHeaders.push({type:"endSeparators",text:s}):[0,1,4].includes(n%6)?this._taggedHeaders.push({type:"headers",text:s}):[2,3,5].includes(n%6)&&this._taggedHeaders.push({type:"footers",text:s}),/[^\r\n\u0002-\u0008]/.test(s)?y(E,M-1,M,"\0"):y(E,O,M,"\0"),O=M}}writeParagraphProperties(l,h){const E=this._pieces,g=l.readUInt32LE(258),d=l.readUInt32LE(262),a=(d-4)/8,m=(a+1)*4,S=h.slice(g,g+d);for(let F=0;F<a;F++){S.readUInt32LE(F*4);const O=S.readUInt32LE(m+F*4),L=l.slice(O*512,(O+1)*512),M=L.readUInt8(511);for(let s=0;s<M;s++){const n=L.readUInt32LE(s*4),v=L.readUInt32LE((s+1)*4),x=(M+1)*4+s*13,A=L.readUInt8(x)*2,N=L.readUInt8(A);let U=null;if(N!==0)U=L.slice(A+1,A+1+2*N-1);else{const z=L.readUInt8(A+1);U=L.slice(A+2,A+2+2*z)}U.readUInt16LE(0),P(U,2,(z,k,$,q,G,Q,te)=>{$===9239&&r(E,n,v,`
`)})}}}writeCharacterProperties(l,h){const E=this._pieces,g=l.readUInt32LE(250),d=l.readUInt32LE(254),a=(d-4)/8,m=(a+1)*4,S=h.slice(g,g+d);let F=null;for(let O=0;O<a;O++){S.readUInt32LE(O*4);const L=S.readUInt32LE(m+O*4),M=l.slice(L*512,(L+1)*512),s=M.readUInt8(511);for(let n=0;n<s;n++){const v=M.readUInt32LE(n*4),x=M.readUInt32LE((n+1)*4),A=M.readUInt8((s+1)*4+n);if(A==0)continue;const N=A*2,U=M.readUInt8(N),z=M.slice(N+1,N+1+U);P(z,0,(k,$,q,G)=>{if(G===_){if((k[$]&1)!=1)return;F===v?B(E,F,x):B(E,v,x),F=x}})}}}}return ze=b,ze}var Se={},qe={},gt;function hi(){return gt||(gt=1,function(c){/**
 * Character classes and associated utilities for the 5th edition of XML 1.0.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(c,"__esModule",{value:!0}),c.CHAR=`	
\r -퟿-�𐀀-􏿿`,c.S=` 	\r
`,c.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",c.NAME_CHAR="-"+c.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",c.CHAR_RE=new RegExp("^["+c.CHAR+"]$","u"),c.S_RE=new RegExp("^["+c.S+"]+$","u"),c.NAME_START_CHAR_RE=new RegExp("^["+c.NAME_START_CHAR+"]$","u"),c.NAME_CHAR_RE=new RegExp("^["+c.NAME_CHAR+"]$","u"),c.NAME_RE=new RegExp("^["+c.NAME_START_CHAR+"]["+c.NAME_CHAR+"]*$","u"),c.NMTOKEN_RE=new RegExp("^["+c.NAME_CHAR+"]+$","u");var T=9,I=10,t=13,_=32;c.S_LIST=[_,I,t,T];function w(i){return i>=_&&i<=55295||i===I||i===t||i===T||i>=57344&&i<=65533||i>=65536&&i<=1114111}c.isChar=w;function p(i){return i===_||i===I||i===t||i===T}c.isS=p;function C(i){return i>=65&&i<=90||i>=97&&i<=122||i===58||i===95||i===8204||i===8205||i>=192&&i<=214||i>=216&&i<=246||i>=248&&i<=767||i>=880&&i<=893||i>=895&&i<=8191||i>=8304&&i<=8591||i>=11264&&i<=12271||i>=12289&&i<=55295||i>=63744&&i<=64975||i>=65008&&i<=65533||i>=65536&&i<=983039}c.isNameStartChar=C;function D(i){return C(i)||i>=48&&i<=57||i===45||i===46||i===183||i>=768&&i<=879||i>=8255&&i<=8256}c.isNameChar=D}(qe)),qe}var We={},bt;function li(){return bt||(bt=1,function(c){/**
 * Character classes and associated utilities for the 2nd edition of XML 1.1.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(c,"__esModule",{value:!0}),c.CHAR="-퟿-�𐀀-􏿿",c.RESTRICTED_CHAR="-\b\v\f---",c.S=` 	\r
`,c.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",c.NAME_CHAR="-"+c.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",c.CHAR_RE=new RegExp("^["+c.CHAR+"]$","u"),c.RESTRICTED_CHAR_RE=new RegExp("^["+c.RESTRICTED_CHAR+"]$","u"),c.S_RE=new RegExp("^["+c.S+"]+$","u"),c.NAME_START_CHAR_RE=new RegExp("^["+c.NAME_START_CHAR+"]$","u"),c.NAME_CHAR_RE=new RegExp("^["+c.NAME_CHAR+"]$","u"),c.NAME_RE=new RegExp("^["+c.NAME_START_CHAR+"]["+c.NAME_CHAR+"]*$","u"),c.NMTOKEN_RE=new RegExp("^["+c.NAME_CHAR+"]+$","u");var T=9,I=10,t=13,_=32;c.S_LIST=[_,I,t,T];function w(r){return r>=1&&r<=55295||r>=57344&&r<=65533||r>=65536&&r<=1114111}c.isChar=w;function p(r){return r>=1&&r<=8||r===11||r===12||r>=14&&r<=31||r>=127&&r<=132||r>=134&&r<=159}c.isRestrictedChar=p;function C(r){return r===9||r===10||r===13||r>31&&r<127||r===133||r>159&&r<=55295||r>=57344&&r<=65533||r>=65536&&r<=1114111}c.isCharAndNotRestricted=C;function D(r){return r===_||r===I||r===t||r===T}c.isS=D;function i(r){return r>=65&&r<=90||r>=97&&r<=122||r===58||r===95||r===8204||r===8205||r>=192&&r<=214||r>=216&&r<=246||r>=248&&r<=767||r>=880&&r<=893||r>=895&&r<=8191||r>=8304&&r<=8591||r>=11264&&r<=12271||r>=12289&&r<=55295||r>=63744&&r<=64975||r>=65008&&r<=65533||r>=65536&&r<=983039}c.isNameStartChar=i;function y(r){return i(r)||r>=48&&r<=57||r===45||r===46||r===183||r>=768&&r<=879||r>=8255&&r<=8256}c.isNameChar=y}(We)),We}var $e={},vt;function di(){return vt||(vt=1,function(c){/**
 * Character class utilities for XML NS 1.0 edition 3.
 *
 * @author Louis-Dominique Dubeau
 * @license MIT
 * @copyright Louis-Dominique Dubeau
 */Object.defineProperty(c,"__esModule",{value:!0}),c.NC_NAME_START_CHAR="A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",c.NC_NAME_CHAR="-"+c.NC_NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",c.NC_NAME_START_CHAR_RE=new RegExp("^["+c.NC_NAME_START_CHAR+"]$","u"),c.NC_NAME_CHAR_RE=new RegExp("^["+c.NC_NAME_CHAR+"]$","u"),c.NC_NAME_RE=new RegExp("^["+c.NC_NAME_START_CHAR+"]["+c.NC_NAME_CHAR+"]*$","u");function T(t){return t>=65&&t<=90||t===95||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}c.isNCNameStartChar=T;function I(t){return T(t)||t===45||t===46||t>=48&&t<=57||t===183||t>=768&&t<=879||t>=8255&&t<=8256}c.isNCNameChar=I}($e)),$e}var St;function fi(){if(St)return Se;St=1,Object.defineProperty(Se,"__esModule",{value:!0});const c=hi(),T=li(),I=di();var t=c.isS,_=c.isChar,w=c.isNameStartChar,p=c.isNameChar,C=c.S_LIST,D=c.NAME_RE,i=T.isChar,y=I.isNCNameStartChar,r=I.isNCNameChar,B=I.NC_NAME_RE;const P="http://www.w3.org/XML/1998/namespace",b="http://www.w3.org/2000/xmlns/",u={__proto__:null,xml:P,xmlns:b},l={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},h=-1,E=-2,g=0,d=1,a=2,m=3,S=4,F=5,O=6,L=7,M=8,s=9,n=10,v=11,x=12,A=13,N=14,U=15,z=16,k=17,$=18,q=19,G=20,Q=21,te=22,re=23,j=24,X=25,V=26,Z=27,ie=28,_e=29,ce=30,Fe=31,le=32,oe=33,Ht=34,Ae=35,Ee=36,De=37,kt=38,Ke=39,Ze=40,zt=41,Je=42,qt=43,Wt=44,Le=9,ne=10,Ie=13,et=32,tt=33,it=34,ge=38,st=39,Ce=45,we=47,$t=59,he=60,fe=61,Y=62,K=63,rt=91,ue=93,nt=133,at=8232,Te=ee=>ee===it||ee===st,ot=[it,st],Xt=[...ot,rt,Y],jt=[...ot,he,ue],Vt=[fe,K,...C],Gt=[...C,Y,ge,he];function Re(ee,e,o){switch(e){case"xml":o!==P&&ee.fail(`xml prefix must be bound to ${P}.`);break;case"xmlns":o!==b&&ee.fail(`xmlns prefix must be bound to ${b}.`);break}switch(o){case b:ee.fail(e===""?`the default namespace may not be set to ${o}.`:`may not assign a prefix (even "xmlns") to the URI ${b}.`);break;case P:switch(e){case"xml":break;case"":ee.fail(`the default namespace may not be set to ${o}.`);break;default:ee.fail("may not assign the xml namespace to another prefix.")}break}}function Yt(ee,e){for(const o of Object.keys(e))Re(ee,o,e[o])}const Qt=ee=>B.test(ee),Kt=ee=>D.test(ee),de=0,ct=1,Ne=2;Se.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const ht={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};class Zt{constructor(e){this.opt=e??{},this.fragmentOpt=!!this.opt.fragment;const o=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,o){this.nameStartCheck=y,this.nameCheck=r,this.isName=Qt,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},u);const f=this.opt.additionalNamespaces;f!=null&&(Yt(this,f),Object.assign(this.ns,f))}else this.nameStartCheck=w,this.nameCheck=p,this.isName=Kt,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=de,this.attribList=[];const{fragmentOpt:o}=this;this.state=o?A:g,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=o,this.xmlDeclPossible=!o,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:f}=this.opt;if(f===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");f="1.0"}this.setXMLVersion(f),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(l),(e=this.readyHandler)===null||e===void 0||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,o){this[ht[e]]=o}off(e){this[ht[e]]=void 0}makeError(e){var o;let f=(o=this.fileName)!==null&&o!==void 0?o:"";return this.trackPosition&&(f.length>0&&(f+=":"),f+=`${this.line}:${this.column}`),f.length>0&&(f+=": "),new Error(f+e)}fail(e){const o=this.makeError(e),f=this.errorHandler;if(f===void 0)throw o;return f(o),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let o=!1;e===null?(o=!0,e=""):typeof e=="object"&&(e=e.toString()),this.carriedFromPrevious!==void 0&&(e=`${this.carriedFromPrevious}${e}`,this.carriedFromPrevious=void 0);let f=e.length;const R=e.charCodeAt(f-1);!o&&(R===Ie||R>=55296&&R<=56319)&&(this.carriedFromPrevious=e[f-1],f--,e=e.slice(0,f));const{stateTable:H}=this;for(this.chunk=e,this.i=0;this.i<f;)H[this.state].call(this);return this.chunkPosition+=f,o?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:e,i:o}=this;if(this.prevI=o,this.i=o+1,o>=e.length)return h;const f=e.charCodeAt(o);if(this.column++,f<55296){if(f>=et||f===Le)return f;switch(f){case ne:return this.line++,this.column=0,this.positionAtNewLine=this.position,ne;case Ie:return e.charCodeAt(o+1)===ne&&(this.i=o+2),this.line++,this.column=0,this.positionAtNewLine=this.position,E;default:return this.fail("disallowed character."),f}}if(f>56319)return f>=57344&&f<=65533||this.fail("disallowed character."),f;const R=65536+(f-55296)*1024+(e.charCodeAt(o+1)-56320);return this.i=o+2,R>1114111&&this.fail("disallowed character."),R}getCode11(){const{chunk:e,i:o}=this;if(this.prevI=o,this.i=o+1,o>=e.length)return h;const f=e.charCodeAt(o);if(this.column++,f<55296){if(f>31&&f<127||f>159&&f!==at||f===Le)return f;switch(f){case ne:return this.line++,this.column=0,this.positionAtNewLine=this.position,ne;case Ie:{const H=e.charCodeAt(o+1);(H===ne||H===nt)&&(this.i=o+2)}case nt:case at:return this.line++,this.column=0,this.positionAtNewLine=this.position,E;default:return this.fail("disallowed character."),f}}if(f>56319)return f>=57344&&f<=65533||this.fail("disallowed character."),f;const R=65536+(f-55296)*1024+(e.charCodeAt(o+1)-56320);return this.i=o+2,R>1114111&&this.fail("disallowed character."),R}getCodeNorm(){const e=this.getCode();return e===E?ne:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i:o}=this;const{chunk:f}=this;for(;;){const R=this.getCode(),H=R===E,W=H?ne:R;if(W===h||e.includes(W))return this.text+=f.slice(o,this.prevI),W;H&&(this.text+=`${f.slice(o,this.prevI)}
`,o=this.i)}}captureToChar(e){let{i:o}=this;const{chunk:f}=this;for(;;){let R=this.getCode();switch(R){case E:this.text+=`${f.slice(o,this.prevI)}
`,o=this.i,R=ne;break;case h:return this.text+=f.slice(o),!1}if(R===e)return this.text+=f.slice(o,this.prevI),!0}}captureNameChars(){const{chunk:e,i:o}=this;for(;;){const f=this.getCode();if(f===h)return this.name+=e.slice(o),h;if(!p(f))return this.name+=e.slice(o,this.prevI),f===E?ne:f}}skipSpaces(){for(;;){const e=this.getCodeNorm();if(e===h||!t(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,e==="1.0"?(this.isChar=_,this.getCode=this.getCode10):(this.isChar=i,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=d}sBeginWhitespace(){const e=this.i,o=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),o){case he:if(this.state=U,this.text.length!==0)throw new Error("no-empty text at start");break;case h:break;default:this.unget(),this.state=A,this.xmlDeclPossible=!1}}sDoctype(){var e;const o=this.captureTo(Xt);switch(o){case Y:{(e=this.doctypeHandler)===null||e===void 0||e.call(this,this.text),this.text="",this.state=A,this.doctype=!0;break}case h:break;default:this.text+=String.fromCodePoint(o),o===rt?this.state=S:Te(o)&&(this.state=m,this.q=o)}}sDoctypeQuote(){const e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=a)}sDTD(){const e=this.captureTo(jt);e!==h&&(this.text+=String.fromCodePoint(e),e===ue?this.state=a:e===he?this.state=O:Te(e)&&(this.state=F,this.q=e))}sDTDQuoted(){const e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=S,this.q=null)}sDTDOpenWaka(){const e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case tt:this.state=L,this.openWakaBang="";break;case K:this.state=v;break;default:this.state=S}}sDTDOpenWakaBang(){const e=String.fromCodePoint(this.getCodeNorm()),o=this.openWakaBang+=e;this.text+=e,o!=="-"&&(this.state=o==="--"?M:S,this.openWakaBang="")}sDTDComment(){this.captureToChar(Ce)&&(this.text+="-",this.state=s)}sDTDCommentEnding(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=e===Ce?n:M}sDTDCommentEnded(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===Y?this.state=S:(this.fail("malformed comment."),this.state=M)}sDTDPI(){this.captureToChar(K)&&(this.text+="?",this.state=x)}sDTDPIEnding(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===Y&&(this.state=S)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this;const{chunk:o}=this;e:for(;;)switch(this.getCode()){case E:this.entity+=`${o.slice(e,this.prevI)}
`,e=this.i;break;case $t:{const{entityReturnState:f}=this,R=this.entity+o.slice(e,this.prevI);this.state=f;let H;R===""?(this.fail("empty entity name."),H="&;"):(H=this.parseEntity(R),this.entity=""),(f!==A||this.textHandler!==void 0)&&(this.text+=H);break e}case h:this.entity+=o.slice(e);break e}}sOpenWaka(){const e=this.getCode();if(w(e))this.state=Ht,this.unget(),this.xmlDeclPossible=!1;else switch(e){case we:this.state=qt,this.xmlDeclPossible=!1;break;case tt:this.state=z,this.openWakaBang="",this.xmlDeclPossible=!1;break;case K:this.state=re;break;default:this.fail("disallowed character in tag name"),this.state=A,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=G,this.openWakaBang="";break;case"--":this.state=k,this.openWakaBang="";break;case"DOCTYPE":this.state=a,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(Ce)&&(this.state=$)}sCommentEnding(){var e;const o=this.getCodeNorm();o===Ce?(this.state=q,(e=this.commentHandler)===null||e===void 0||e.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(o)}`,this.state=k)}sCommentEnded(){const e=this.getCodeNorm();e!==Y?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(e)}`,this.state=k):this.state=A}sCData(){this.captureToChar(ue)&&(this.state=Q)}sCDataEnding(){const e=this.getCodeNorm();e===ue?this.state=te:(this.text+=`]${String.fromCodePoint(e)}`,this.state=G)}sCDataEnding2(){var e;const o=this.getCodeNorm();switch(o){case Y:{(e=this.cdataHandler)===null||e===void 0||e.call(this,this.text),this.text="",this.state=A;break}case ue:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(o)}`,this.state=G}}sPIFirstChar(){const e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=j):e===K||t(e)?(this.fail("processing instruction without a target."),this.state=e===K?V:X):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=j)}sPIRest(){const{chunk:e,i:o}=this;for(;;){const f=this.getCodeNorm();if(f===h){this.piTarget+=e.slice(o);return}if(!this.nameCheck(f)){this.piTarget+=e.slice(o,this.prevI);const R=f===K;R||t(f)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=R?oe:Z):this.state=R?V:X:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(f));break}}}sPIBody(){if(this.text.length===0){const e=this.getCodeNorm();e===K?this.state=V:t(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(K)&&(this.state=V)}sPIEnding(){var e;const o=this.getCodeNorm();if(o===Y){const{piTarget:f}=this;f.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(e=this.piHandler)===null||e===void 0||e.call(this,{target:f,body:this.text}),this.piTarget=this.text="",this.state=A}else o===K?this.text+="?":(this.text+=`?${String.fromCodePoint(o)}`,this.state=X);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const e=this.skipSpaces();if(e===K){this.state=oe;return}e!==h&&(this.state=ie,this.name=String.fromCodePoint(e))}sXMLDeclName(){const e=this.captureTo(Vt);if(e===K){this.state=oe,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(t(e)||e===fe){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=e===fe?ce:_e}}sXMLDeclEq(){const e=this.getCodeNorm();if(e===K){this.state=oe,this.fail("XML declaration is incomplete.");return}t(e)||(e!==fe&&this.fail("value required."),this.state=ce)}sXMLDeclValueStart(){const e=this.getCodeNorm();if(e===K){this.state=oe,this.fail("XML declaration is incomplete.");return}t(e)||(Te(e)?this.q=e:(this.fail("value must be quoted."),this.q=et),this.state=Fe)}sXMLDeclValue(){const e=this.captureTo([this.q,K]);if(e===K){this.state=oe,this.text="",this.fail("XML declaration is incomplete.");return}if(e===h)return;const o=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const f=o;this.xmlDecl.version=f,/^1\.[0-9]+$/.test(f)?this.opt.forceXMLVersion||this.setXMLVersion(f):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(o)||this.fail("encoding value must match 	/^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=o;break;case"standalone":o!=="yes"&&o!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=o;break}this.name="",this.state=le}sXMLDeclSeparator(){const e=this.getCodeNorm();if(e===K){this.state=oe;return}t(e)||(this.fail("whitespace required."),this.unget()),this.state=Z}sXMLDeclEnding(){var e;this.getCodeNorm()===Y?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(e=this.xmldeclHandler)===null||e===void 0||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=A):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;const o=this.captureNameChars();if(o===h)return;const f=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=f.ns=Object.create(null)),(e=this.openTagStartHandler)===null||e===void 0||e.call(this,f),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),o){case Y:this.openTag();break;case we:this.state=Ae;break;default:t(o)||this.fail("disallowed character in tag name."),this.state=Ee}}sOpenTagSlash(){this.getCode()===Y?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=Ee)}sAttrib(){const e=this.skipSpaces();e!==h&&(w(e)?(this.unget(),this.state=De):e===Y?this.openTag():e===we?this.state=Ae:this.fail("disallowed character in attribute name."))}sAttribName(){const e=this.captureNameChars();e===fe?this.state=Ke:t(e)?this.state=kt:e===Y?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):e!==h&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const e=this.skipSpaces();switch(e){case h:return;case fe:this.state=Ke;break;default:this.fail("attribute without value."),this.text="",this.name="",e===Y?this.openTag():w(e)?(this.unget(),this.state=De):(this.fail("disallowed character in attribute name."),this.state=Ee)}}sAttribValue(){const e=this.getCodeNorm();Te(e)?(this.q=e,this.state=Ze):t(e)||(this.fail("unquoted attribute value."),this.state=Je,this.unget())}sAttribValueQuoted(){const{q:e,chunk:o}=this;let{i:f}=this;for(;;)switch(this.getCode()){case e:this.pushAttrib(this.name,this.text+o.slice(f,this.prevI)),this.name=this.text="",this.q=null,this.state=zt;return;case ge:this.text+=o.slice(f,this.prevI),this.state=N,this.entityReturnState=Ze;return;case ne:case E:case Le:this.text+=`${o.slice(f,this.prevI)} `,f=this.i;break;case he:this.text+=o.slice(f,this.prevI),this.fail("disallowed character.");return;case h:this.text+=o.slice(f);return}}sAttribValueClosed(){const e=this.getCodeNorm();t(e)?this.state=Ee:e===Y?this.openTag():e===we?this.state=Ae:w(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=De):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const e=this.captureTo(Gt);switch(e){case ge:this.state=N,this.entityReturnState=Je;break;case he:this.fail("disallowed character.");break;case h:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",e===Y?this.openTag():this.state=Ee}}sCloseTag(){const e=this.captureNameChars();e===Y?this.closeTag():t(e)?this.state=Wt:e!==h&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case Y:this.closeTag();break;case h:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:o}=this;const{chunk:f,textHandler:R}=this;e:for(;;)switch(this.getCode()){case he:{if(this.state=U,R!==void 0){const{text:H}=this,W=f.slice(e,this.prevI);H.length!==0?(R(H+W),this.text=""):W.length!==0&&R(W)}o=de;break e}case ge:this.state=N,this.entityReturnState=A,R!==void 0&&(this.text+=f.slice(e,this.prevI)),o=de;break e;case ue:switch(o){case de:o=ct;break;case ct:o=Ne;break;case Ne:break;default:throw new Error("impossible state")}break;case Y:o===Ne&&this.fail('the string "]]>" is disallowed in char data.'),o=de;break;case E:R!==void 0&&(this.text+=`${f.slice(e,this.prevI)}
`),e=this.i,o=de;break;case h:R!==void 0&&(this.text+=f.slice(e));break e;default:o=de}this.forbiddenState=o}handleTextOutsideRoot(){let{i:e}=this;const{chunk:o,textHandler:f}=this;let R=!1;e:for(;;){const H=this.getCode();switch(H){case he:{if(this.state=U,f!==void 0){const{text:W}=this,J=o.slice(e,this.prevI);W.length!==0?(f(W+J),this.text=""):J.length!==0&&f(J)}break e}case ge:this.state=N,this.entityReturnState=A,f!==void 0&&(this.text+=o.slice(e,this.prevI)),R=!0;break e;case E:f!==void 0&&(this.text+=`${o.slice(e,this.prevI)}
`),e=this.i;break;case h:f!==void 0&&(this.text+=o.slice(e));break e;default:t(H)||(R=!0)}}R&&(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,o){var f;const{prefix:R,local:H}=this.qname(e),W={name:e,prefix:R,local:H,value:o};if(this.attribList.push(W),(f=this.attributeHandler)===null||f===void 0||f.call(this,W),R==="xmlns"){const J=o.trim();this.currentXMLVersion==="1.0"&&J===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[H]=J,Re(this,H,J)}else if(e==="xmlns"){const J=o.trim();this.topNS[""]=J,Re(this,"",J)}}pushAttribPlain(e,o){var f;const R={name:e,value:o};this.attribList.push(R),(f=this.attributeHandler)===null||f===void 0||f.call(this,R)}end(){var e,o;this.sawRoot||this.fail("document must contain a root element.");const{tags:f}=this;for(;f.length>0;){const H=f.pop();this.fail(`unclosed tag: ${H.name}`)}this.state!==g&&this.state!==A&&this.fail("unexpected end.");const{text:R}=this;return R.length!==0&&((e=this.textHandler)===null||e===void 0||e.call(this,R),this.text=""),this._closed=!0,(o=this.endHandler)===null||o===void 0||o.call(this),this._init(),this}resolve(e){var o,f;let R=this.topNS[e];if(R!==void 0)return R;const{tags:H}=this;for(let W=H.length-1;W>=0;W--)if(R=H[W].ns[e],R!==void 0)return R;return R=this.ns[e],R!==void 0?R:(f=(o=this.opt).resolvePrefix)===null||f===void 0?void 0:f.call(o,e)}qname(e){const o=e.indexOf(":");if(o===-1)return{prefix:"",local:e};const f=e.slice(o+1),R=e.slice(0,o);return(R===""||f===""||f.includes(":"))&&this.fail(`malformed name: ${e}.`),{prefix:R,local:f}}processAttribsNS(){var e;const{attribList:o}=this,f=this.tag;{const{prefix:W,local:J}=this.qname(f.name);f.prefix=W,f.local=J;const xe=f.uri=(e=this.resolve(W))!==null&&e!==void 0?e:"";W!==""&&(W==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),xe===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(W)}.`),f.uri=W))}if(o.length===0)return;const{attributes:R}=f,H=new Set;for(const W of o){const{name:J,prefix:xe,local:Jt}=W;let me,be;xe===""?(me=J==="xmlns"?b:"",be=J):(me=this.resolve(xe),me===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(xe)}.`),me=xe),be=`{${me}}${Jt}`),H.has(be)&&this.fail(`duplicate attribute: ${be}.`),H.add(be),W.uri=me,R[J]=W}this.attribList=[]}processAttribsPlain(){const{attribList:e}=this,o=this.tag.attributes;for(const{name:f,value:R}of e)o[f]!==void 0&&this.fail(`duplicate attribute: ${f}.`),o[f]=R;this.attribList=[]}openTag(){var e;this.processAttribs();const{tags:o}=this,f=this.tag;f.isSelfClosing=!1,(e=this.openTagHandler)===null||e===void 0||e.call(this,f),o.push(f),this.state=A,this.name=""}openSelfClosingTag(){var e,o,f;this.processAttribs();const{tags:R}=this,H=this.tag;H.isSelfClosing=!0,(e=this.openTagHandler)===null||e===void 0||e.call(this,H),(o=this.closeTagHandler)===null||o===void 0||o.call(this,H),(this.tag=(f=R[R.length-1])!==null&&f!==void 0?f:null)===null&&(this.closedRoot=!0),this.state=A,this.name=""}closeTag(){const{tags:e,name:o}=this;if(this.state=A,this.name="",o===""){this.fail("weird empty close tag."),this.text+="</>";return}const f=this.closeTagHandler;let R=e.length;for(;R-- >0;){const H=this.tag=e.pop();if(this.topNS=H.ns,f?.(H),H.name===o)break;this.fail("unexpected close tag.")}R===0?this.closedRoot=!0:R<0&&(this.fail(`unmatched closing tag: ${o}.`),this.text+=`</${o}>`)}parseEntity(e){if(e[0]!=="#"){const f=this.ENTITIES[e];return f!==void 0?f:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),`&${e};`)}let o=NaN;return e[1]==="x"&&/^#x[0-9a-f]+$/i.test(e)?o=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(o=parseInt(e.slice(1),10)),this.isChar(o)?String.fromCodePoint(o):(this.fail("malformed character entity."),`&${e};`)}}return Se.SaxesParser=Zt,Se}var ae={},pe={},Xe,Ct;function ui(){if(Ct)return Xe;Ct=1,Xe=c;function c(){this.pending=0,this.max=1/0,this.listeners=[],this.waiting=[],this.error=null}c.prototype.go=function(t){this.pending<this.max?I(this,t):this.waiting.push(t)},c.prototype.wait=function(t){this.pending===0?t(this.error):this.listeners.push(t)},c.prototype.hold=function(){return T(this)};function T(t){t.pending+=1;var _=!1;return w;function w(C){if(_)throw new Error("callback called twice");if(_=!0,t.error=t.error||C,t.pending-=1,t.waiting.length>0&&t.pending<t.max)I(t,t.waiting.shift());else if(t.pending===0){var D=t.listeners;t.listeners=[],D.forEach(p)}}function p(C){C(t.error)}}function I(t,_){_(T(t))}return Xe}var ye={exports:{}},wt;function Pt(){if(wt)return ye.exports;wt=1;var c=typeof Reflect=="object"?Reflect:null,T=c&&typeof c.apply=="function"?c.apply:function(a,m,S){return Function.prototype.apply.call(a,m,S)},I;c&&typeof c.ownKeys=="function"?I=c.ownKeys:Object.getOwnPropertySymbols?I=function(a){return Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a))}:I=function(a){return Object.getOwnPropertyNames(a)};function t(d){console&&console.warn&&console.warn(d)}var _=Number.isNaN||function(a){return a!==a};function w(){w.init.call(this)}ye.exports=w,ye.exports.once=h,w.EventEmitter=w,w.prototype._events=void 0,w.prototype._eventsCount=0,w.prototype._maxListeners=void 0;var p=10;function C(d){if(typeof d!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof d)}Object.defineProperty(w,"defaultMaxListeners",{enumerable:!0,get:function(){return p},set:function(d){if(typeof d!="number"||d<0||_(d))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+d+".");p=d}}),w.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},w.prototype.setMaxListeners=function(a){if(typeof a!="number"||a<0||_(a))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+a+".");return this._maxListeners=a,this};function D(d){return d._maxListeners===void 0?w.defaultMaxListeners:d._maxListeners}w.prototype.getMaxListeners=function(){return D(this)},w.prototype.emit=function(a){for(var m=[],S=1;S<arguments.length;S++)m.push(arguments[S]);var F=a==="error",O=this._events;if(O!==void 0)F=F&&O.error===void 0;else if(!F)return!1;if(F){var L;if(m.length>0&&(L=m[0]),L instanceof Error)throw L;var M=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw M.context=L,M}var s=O[a];if(s===void 0)return!1;if(typeof s=="function")T(s,this,m);else for(var n=s.length,v=b(s,n),S=0;S<n;++S)T(v[S],this,m);return!0};function i(d,a,m,S){var F,O,L;if(C(m),O=d._events,O===void 0?(O=d._events=Object.create(null),d._eventsCount=0):(O.newListener!==void 0&&(d.emit("newListener",a,m.listener?m.listener:m),O=d._events),L=O[a]),L===void 0)L=O[a]=m,++d._eventsCount;else if(typeof L=="function"?L=O[a]=S?[m,L]:[L,m]:S?L.unshift(m):L.push(m),F=D(d),F>0&&L.length>F&&!L.warned){L.warned=!0;var M=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+String(a)+" listeners added. Use emitter.setMaxListeners() to increase limit");M.name="MaxListenersExceededWarning",M.emitter=d,M.type=a,M.count=L.length,t(M)}return d}w.prototype.addListener=function(a,m){return i(this,a,m,!1)},w.prototype.on=w.prototype.addListener,w.prototype.prependListener=function(a,m){return i(this,a,m,!0)};function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(d,a,m){var S={fired:!1,wrapFn:void 0,target:d,type:a,listener:m},F=y.bind(S);return F.listener=m,S.wrapFn=F,F}w.prototype.once=function(a,m){return C(m),this.on(a,r(this,a,m)),this},w.prototype.prependOnceListener=function(a,m){return C(m),this.prependListener(a,r(this,a,m)),this},w.prototype.removeListener=function(a,m){var S,F,O,L,M;if(C(m),F=this._events,F===void 0)return this;if(S=F[a],S===void 0)return this;if(S===m||S.listener===m)--this._eventsCount===0?this._events=Object.create(null):(delete F[a],F.removeListener&&this.emit("removeListener",a,S.listener||m));else if(typeof S!="function"){for(O=-1,L=S.length-1;L>=0;L--)if(S[L]===m||S[L].listener===m){M=S[L].listener,O=L;break}if(O<0)return this;O===0?S.shift():u(S,O),S.length===1&&(F[a]=S[0]),F.removeListener!==void 0&&this.emit("removeListener",a,M||m)}return this},w.prototype.off=w.prototype.removeListener,w.prototype.removeAllListeners=function(a){var m,S,F;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[a]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[a]),this;if(arguments.length===0){var O=Object.keys(S),L;for(F=0;F<O.length;++F)L=O[F],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(m=S[a],typeof m=="function")this.removeListener(a,m);else if(m!==void 0)for(F=m.length-1;F>=0;F--)this.removeListener(a,m[F]);return this};function B(d,a,m){var S=d._events;if(S===void 0)return[];var F=S[a];return F===void 0?[]:typeof F=="function"?m?[F.listener||F]:[F]:m?l(F):b(F,F.length)}w.prototype.listeners=function(a){return B(this,a,!0)},w.prototype.rawListeners=function(a){return B(this,a,!1)},w.listenerCount=function(d,a){return typeof d.listenerCount=="function"?d.listenerCount(a):P.call(d,a)},w.prototype.listenerCount=P;function P(d){var a=this._events;if(a!==void 0){var m=a[d];if(typeof m=="function")return 1;if(m!==void 0)return m.length}return 0}w.prototype.eventNames=function(){return this._eventsCount>0?I(this._events):[]};function b(d,a){for(var m=new Array(a),S=0;S<a;++S)m[S]=d[S];return m}function u(d,a){for(;a+1<d.length;a++)d[a]=d[a+1];d.pop()}function l(d){for(var a=new Array(d.length),m=0;m<a.length;++m)a[m]=d[m].listener||d[m];return a}function h(d,a){return new Promise(function(m,S){function F(L){d.removeListener(a,O),S(L)}function O(){typeof d.removeListener=="function"&&d.removeListener("error",F),m([].slice.call(arguments))}g(d,a,O,{once:!0}),a!=="error"&&E(d,F,{once:!0})})}function E(d,a,m){typeof d.on=="function"&&g(d,"error",a,m)}function g(d,a,m,S){if(typeof d.on=="function")S.once?d.once(a,m):d.on(a,m);else if(typeof d.addEventListener=="function")d.addEventListener(a,function F(O){S.once&&d.removeEventListener(a,F),m(O)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof d)}return ye.exports}var Tt;function xi(){if(Tt)return pe;Tt=1;var c=se,T=se,I=se,t=I.Readable,_=I.Writable,w=I.PassThrough,p=ui(),C=Pt().EventEmitter;pe.createFromBuffer=B,pe.createFromFd=P,pe.BufferSlicer=r,pe.FdSlicer=D,T.inherits(D,C);function D(b,u){u=u||{},C.call(this),this.fd=b,this.pend=new p,this.pend.max=1,this.refCount=0,this.autoClose=!!u.autoClose}D.prototype.read=function(b,u,l,h,E){var g=this;g.pend.go(function(d){c.read(g.fd,b,u,l,h,function(a,m,S){d(),E(a,m,S)})})},D.prototype.write=function(b,u,l,h,E){var g=this;g.pend.go(function(d){c.write(g.fd,b,u,l,h,function(a,m,S){d(),E(a,m,S)})})},D.prototype.createReadStream=function(b){return new i(this,b)},D.prototype.createWriteStream=function(b){return new y(this,b)},D.prototype.ref=function(){this.refCount+=1},D.prototype.unref=function(){var b=this;if(b.refCount-=1,b.refCount>0)return;if(b.refCount<0)throw new Error("invalid unref");b.autoClose&&c.close(b.fd,u);function u(l){l?b.emit("error",l):b.emit("close")}},T.inherits(i,t);function i(b,u){u=u||{},t.call(this,u),this.context=b,this.context.ref(),this.start=u.start||0,this.endOffset=u.end,this.pos=this.start,this.destroyed=!1}i.prototype._read=function(b){var u=this;if(!u.destroyed){var l=Math.min(u._readableState.highWaterMark,b);if(u.endOffset!=null&&(l=Math.min(l,u.endOffset-u.pos)),l<=0){u.destroyed=!0,u.push(null),u.context.unref();return}u.context.pend.go(function(h){if(u.destroyed)return h();var E=new Buffer(l);c.read(u.context.fd,E,0,l,u.pos,function(g,d){g?u.destroy(g):d===0?(u.destroyed=!0,u.push(null),u.context.unref()):(u.pos+=d,u.push(E.slice(0,d))),h()})})}},i.prototype.destroy=function(b){this.destroyed||(b=b||new Error("stream destroyed"),this.destroyed=!0,this.emit("error",b),this.context.unref())},T.inherits(y,_);function y(b,u){u=u||{},_.call(this,u),this.context=b,this.context.ref(),this.start=u.start||0,this.endOffset=u.end==null?1/0:+u.end,this.bytesWritten=0,this.pos=this.start,this.destroyed=!1,this.on("finish",this.destroy.bind(this))}y.prototype._write=function(b,u,l){var h=this;if(!h.destroyed){if(h.pos+b.length>h.endOffset){var E=new Error("maximum file length exceeded");E.code="ETOOBIG",h.destroy(),l(E);return}h.context.pend.go(function(g){if(h.destroyed)return g();c.write(h.context.fd,b,0,b.length,h.pos,function(d,a){d?(h.destroy(),g(),l(d)):(h.bytesWritten+=a,h.pos+=a,h.emit("progress"),g(),l())})})}},y.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.context.unref())},T.inherits(r,C);function r(b,u){C.call(this),u=u||{},this.refCount=0,this.buffer=b,this.maxChunkSize=u.maxChunkSize||Number.MAX_SAFE_INTEGER}r.prototype.read=function(b,u,l,h,E){var g=h+l,d=g-this.buffer.length,a=d>0?d:l;this.buffer.copy(b,u,h,g),setImmediate(function(){E(null,a)})},r.prototype.write=function(b,u,l,h,E){b.copy(this.buffer,h,u,u+l),setImmediate(function(){E(null,l,b)})},r.prototype.createReadStream=function(b){b=b||{};var u=new w(b);u.destroyed=!1,u.start=b.start||0,u.endOffset=b.end,u.pos=u.endOffset||this.buffer.length;for(var l=this.buffer.slice(u.start,u.pos),h=0;;){var E=h+this.maxChunkSize;if(E>=l.length){h<l.length&&u.write(l.slice(h,l.length));break}u.write(l.slice(h,E)),h=E}return u.end(),u.destroy=function(){u.destroyed=!0},u},r.prototype.createWriteStream=function(b){var u=this;b=b||{};var l=new _(b);return l.start=b.start||0,l.endOffset=b.end==null?this.buffer.length:+b.end,l.bytesWritten=0,l.pos=l.start,l.destroyed=!1,l._write=function(h,E,g){if(!l.destroyed){var d=l.pos+h.length;if(d>l.endOffset){var a=new Error("maximum file length exceeded");a.code="ETOOBIG",l.destroyed=!0,g(a);return}h.copy(u.buffer,l.pos,0,h.length),l.bytesWritten+=h.length,l.pos=d,l.emit("progress"),g()}},l.destroy=function(){l.destroyed=!0},l},r.prototype.ref=function(){this.refCount+=1},r.prototype.unref=function(){if(this.refCount-=1,this.refCount<0)throw new Error("invalid unref")};function B(b,u){return new r(b,u)}function P(b,u){return new D(b,u)}return pe}var je,yt;function mi(){if(yt)return je;yt=1;var c=Rt().Buffer,T=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(T=new Int32Array(T));function I(p){if(c.isBuffer(p))return p;var C=typeof c.alloc=="function"&&typeof c.from=="function";if(typeof p=="number")return C?c.alloc(p):new c(p);if(typeof p=="string")return C?c.from(p):new c(p);throw new Error("input must be buffer, number, or string, received "+typeof p)}function t(p){var C=I(4);return C.writeInt32BE(p,0),C}function _(p,C){p=I(p),c.isBuffer(C)&&(C=C.readUInt32BE(0));for(var D=~~C^-1,i=0;i<p.length;i++)D=T[(D^p[i])&255]^D>>>8;return D^-1}function w(){return t(_.apply(null,arguments))}return w.signed=function(){return _.apply(null,arguments)},w.unsigned=function(){return _.apply(null,arguments)>>>0},je=w,je}var Ft;function pi(){if(Ft)return ae;Ft=1;var c=se,T=se,I=xi(),t=mi(),_=se,w=Pt().EventEmitter,p=se.Transform,C=se.PassThrough,D=se.Writable;ae.open=i,ae.fromFd=y,ae.fromBuffer=r,ae.fromRandomAccessReader=B,ae.dosDateTimeToDate=h,ae.validateFileName=E,ae.ZipFile=P,ae.Entry=l,ae.RandomAccessReader=a;function i(s,n,v){typeof n=="function"&&(v=n,n=null),n==null&&(n={}),n.autoClose==null&&(n.autoClose=!0),n.lazyEntries==null&&(n.lazyEntries=!1),n.decodeStrings==null&&(n.decodeStrings=!0),n.validateEntrySizes==null&&(n.validateEntrySizes=!0),n.strictFileNames==null&&(n.strictFileNames=!1),v==null&&(v=M),c.open(s,"r",function(x,A){if(x)return v(x);y(A,n,function(N,U){N&&c.close(A,M),v(N,U)})})}function y(s,n,v){typeof n=="function"&&(v=n,n=null),n==null&&(n={}),n.autoClose==null&&(n.autoClose=!1),n.lazyEntries==null&&(n.lazyEntries=!1),n.decodeStrings==null&&(n.decodeStrings=!0),n.validateEntrySizes==null&&(n.validateEntrySizes=!0),n.strictFileNames==null&&(n.strictFileNames=!1),v==null&&(v=M),c.fstat(s,function(x,A){if(x)return v(x);var N=I.createFromFd(s,{autoClose:!0});B(N,A.size,n,v)})}function r(s,n,v){typeof n=="function"&&(v=n,n=null),n==null&&(n={}),n.autoClose=!1,n.lazyEntries==null&&(n.lazyEntries=!1),n.decodeStrings==null&&(n.decodeStrings=!0),n.validateEntrySizes==null&&(n.validateEntrySizes=!0),n.strictFileNames==null&&(n.strictFileNames=!1);var x=I.createFromBuffer(s,{maxChunkSize:65536});B(x,s.length,n,v)}function B(s,n,v,x){typeof v=="function"&&(x=v,v=null),v==null&&(v={}),v.autoClose==null&&(v.autoClose=!0),v.lazyEntries==null&&(v.lazyEntries=!1),v.decodeStrings==null&&(v.decodeStrings=!0);var A=!!v.decodeStrings;if(v.validateEntrySizes==null&&(v.validateEntrySizes=!0),v.strictFileNames==null&&(v.strictFileNames=!1),x==null&&(x=M),typeof n!="number")throw new Error("expected totalSize parameter to be a number");if(n>Number.MAX_SAFE_INTEGER)throw new Error("zip file too large. only file sizes up to 2^52 are supported due to JavaScript's Number type being an IEEE 754 double.");s.ref();var N=22,U=65535,z=Math.min(N+U,n),k=L(z),$=n-k.length;g(s,k,0,z,$,function(q){if(q)return x(q);for(var G=z-N;G>=0;G-=1)if(k.readUInt32LE(G)===101010256){var Q=k.slice(G),te=Q.readUInt16LE(4);if(te!==0)return x(new Error("multi-disk zip files are not supported: found disk number: "+te));var re=Q.readUInt16LE(10),j=Q.readUInt32LE(16),X=Q.readUInt16LE(20),V=Q.length-N;if(X!==V)return x(new Error("invalid comment length. expected: "+V+". found: "+X));var Z=A?F(Q,22,Q.length,!1):Q.slice(22);if(!(re===65535||j===4294967295))return x(null,new P(s,j,n,re,Z,v.autoClose,v.lazyEntries,A,v.validateEntrySizes,v.strictFileNames));var ie=L(20),_e=$+G-ie.length;g(s,ie,0,ie.length,_e,function(ce){if(ce)return x(ce);if(ie.readUInt32LE(0)!==117853008)return x(new Error("invalid zip64 end of central directory locator signature"));var Fe=O(ie,8),le=L(56);g(s,le,0,le.length,Fe,function(oe){return oe?x(oe):le.readUInt32LE(0)!==101075792?x(new Error("invalid zip64 end of central directory record signature")):(re=O(le,32),j=O(le,48),x(null,new P(s,j,n,re,Z,v.autoClose,v.lazyEntries,A,v.validateEntrySizes,v.strictFileNames)))})});return}x(new Error("end of central directory record signature not found"))})}_.inherits(P,w);function P(s,n,v,x,A,N,U,z,k,$){var q=this;w.call(q),q.reader=s,q.reader.on("error",function(G){u(q,G)}),q.reader.once("close",function(){q.emit("close")}),q.readEntryCursor=n,q.fileSize=v,q.entryCount=x,q.comment=A,q.entriesRead=0,q.autoClose=!!N,q.lazyEntries=!!U,q.decodeStrings=!!z,q.validateEntrySizes=!!k,q.strictFileNames=!!$,q.isOpen=!0,q.emittedError=!1,q.lazyEntries||q._readEntry()}P.prototype.close=function(){this.isOpen&&(this.isOpen=!1,this.reader.unref())};function b(s,n){s.autoClose&&s.close(),u(s,n)}function u(s,n){s.emittedError||(s.emittedError=!0,s.emit("error",n))}P.prototype.readEntry=function(){if(!this.lazyEntries)throw new Error("readEntry() called without lazyEntries:true");this._readEntry()},P.prototype._readEntry=function(){var s=this;if(s.entryCount===s.entriesRead){setImmediate(function(){s.autoClose&&s.close(),!s.emittedError&&s.emit("end")});return}if(!s.emittedError){var n=L(46);g(s.reader,n,0,n.length,s.readEntryCursor,function(v){if(v)return b(s,v);if(!s.emittedError){var x=new l,A=n.readUInt32LE(0);if(A!==33639248)return b(s,new Error("invalid central directory file header signature: 0x"+A.toString(16)));if(x.versionMadeBy=n.readUInt16LE(4),x.versionNeededToExtract=n.readUInt16LE(6),x.generalPurposeBitFlag=n.readUInt16LE(8),x.compressionMethod=n.readUInt16LE(10),x.lastModFileTime=n.readUInt16LE(12),x.lastModFileDate=n.readUInt16LE(14),x.crc32=n.readUInt32LE(16),x.compressedSize=n.readUInt32LE(20),x.uncompressedSize=n.readUInt32LE(24),x.fileNameLength=n.readUInt16LE(28),x.extraFieldLength=n.readUInt16LE(30),x.fileCommentLength=n.readUInt16LE(32),x.internalFileAttributes=n.readUInt16LE(36),x.externalFileAttributes=n.readUInt32LE(38),x.relativeOffsetOfLocalHeader=n.readUInt32LE(42),x.generalPurposeBitFlag&64)return b(s,new Error("strong encryption is not supported"));s.readEntryCursor+=46,n=L(x.fileNameLength+x.extraFieldLength+x.fileCommentLength),g(s.reader,n,0,n.length,s.readEntryCursor,function(N){if(N)return b(s,N);if(!s.emittedError){var U=(x.generalPurposeBitFlag&2048)!==0;x.fileName=s.decodeStrings?F(n,0,x.fileNameLength,U):n.slice(0,x.fileNameLength);var z=x.fileNameLength+x.extraFieldLength,k=n.slice(x.fileNameLength,z);x.extraFields=[];for(var $=0;$<k.length-3;){var q=k.readUInt16LE($+0),G=k.readUInt16LE($+2),Q=$+4,te=Q+G;if(te>k.length)return b(s,new Error("extra field length exceeds extra field buffer size"));var re=L(G);k.copy(re,0,Q,te),x.extraFields.push({id:q,data:re}),$=te}if(x.fileComment=s.decodeStrings?F(n,z,z+x.fileCommentLength,U):n.slice(z,z+x.fileCommentLength),x.comment=x.fileComment,s.readEntryCursor+=n.length,s.entriesRead+=1,x.uncompressedSize===4294967295||x.compressedSize===4294967295||x.relativeOffsetOfLocalHeader===4294967295){for(var j=null,$=0;$<x.extraFields.length;$++){var X=x.extraFields[$];if(X.id===1){j=X.data;break}}if(j==null)return b(s,new Error("expected zip64 extended information extra field"));var V=0;if(x.uncompressedSize===4294967295){if(V+8>j.length)return b(s,new Error("zip64 extended information extra field does not include uncompressed size"));x.uncompressedSize=O(j,V),V+=8}if(x.compressedSize===4294967295){if(V+8>j.length)return b(s,new Error("zip64 extended information extra field does not include compressed size"));x.compressedSize=O(j,V),V+=8}if(x.relativeOffsetOfLocalHeader===4294967295){if(V+8>j.length)return b(s,new Error("zip64 extended information extra field does not include relative header offset"));x.relativeOffsetOfLocalHeader=O(j,V),V+=8}}if(s.decodeStrings)for(var $=0;$<x.extraFields.length;$++){var X=x.extraFields[$];if(X.id===28789){if(X.data.length<6||X.data.readUInt8(0)!==1)continue;var Z=X.data.readUInt32LE(1);if(t.unsigned(n.slice(0,x.fileNameLength))!==Z)continue;x.fileName=F(X.data,5,X.data.length,!0);break}}if(s.validateEntrySizes&&x.compressionMethod===0){var ie=x.uncompressedSize;if(x.isEncrypted()&&(ie+=12),x.compressedSize!==ie){var _e="compressed/uncompressed size mismatch for stored file: "+x.compressedSize+" != "+x.uncompressedSize;return b(s,new Error(_e))}}if(s.decodeStrings){s.strictFileNames||(x.fileName=x.fileName.replace(/\\/g,"/"));var ce=E(x.fileName,s.validateFileNameOptions);if(ce!=null)return b(s,new Error(ce))}s.emit("entry",x),s.lazyEntries||s._readEntry()}})}})}},P.prototype.openReadStream=function(s,n,v){var x=this,A=0,N=s.compressedSize;if(v==null)v=n,n={};else{if(n.decrypt!=null){if(!s.isEncrypted())throw new Error("options.decrypt can only be specified for encrypted entries");if(n.decrypt!==!1)throw new Error("invalid options.decrypt value: "+n.decrypt);if(s.isCompressed()&&n.decompress!==!1)throw new Error("entry is encrypted and compressed, and options.decompress !== false")}if(n.decompress!=null){if(!s.isCompressed())throw new Error("options.decompress can only be specified for compressed entries");if(!(n.decompress===!1||n.decompress===!0))throw new Error("invalid options.decompress value: "+n.decompress)}if(n.start!=null||n.end!=null){if(s.isCompressed()&&n.decompress!==!1)throw new Error("start/end range not allowed for compressed entry without options.decompress === false");if(s.isEncrypted()&&n.decrypt!==!1)throw new Error("start/end range not allowed for encrypted entry without options.decrypt === false")}if(n.start!=null){if(A=n.start,A<0)throw new Error("options.start < 0");if(A>s.compressedSize)throw new Error("options.start > entry.compressedSize")}if(n.end!=null){if(N=n.end,N<0)throw new Error("options.end < 0");if(N>s.compressedSize)throw new Error("options.end > entry.compressedSize");if(N<A)throw new Error("options.end < options.start")}}if(!x.isOpen)return v(new Error("closed"));if(s.isEncrypted()&&n.decrypt!==!1)return v(new Error("entry is encrypted, and options.decrypt !== false"));x.reader.ref();var U=L(30);g(x.reader,U,0,U.length,s.relativeOffsetOfLocalHeader,function(z){try{if(z)return v(z);var k=U.readUInt32LE(0);if(k!==67324752)return v(new Error("invalid local file header signature: 0x"+k.toString(16)));var $=U.readUInt16LE(26),q=U.readUInt16LE(28),G=s.relativeOffsetOfLocalHeader+U.length+$+q,Q;if(s.compressionMethod===0)Q=!1;else if(s.compressionMethod===8)Q=n.decompress!=null?n.decompress:!0;else return v(new Error("unsupported compression method: "+s.compressionMethod));var te=G,re=te+s.compressedSize;if(s.compressedSize!==0&&re>x.fileSize)return v(new Error("file data overflows file bounds: "+te+" + "+s.compressedSize+" > "+x.fileSize));var j=x.reader.createReadStream({start:te+A,end:te+N}),X=j;if(Q){var V=!1,Z=T.createInflateRaw();j.on("error",function(ie){setImmediate(function(){V||Z.emit("error",ie)})}),j.pipe(Z),x.validateEntrySizes?(X=new d(s.uncompressedSize),Z.on("error",function(ie){setImmediate(function(){V||X.emit("error",ie)})}),Z.pipe(X)):X=Z,X.destroy=function(){V=!0,Z!==X&&Z.unpipe(X),j.unpipe(Z),j.destroy()}}v(null,X)}finally{x.reader.unref()}})};function l(){}l.prototype.getLastModDate=function(){return h(this.lastModFileDate,this.lastModFileTime)},l.prototype.isEncrypted=function(){return(this.generalPurposeBitFlag&1)!==0},l.prototype.isCompressed=function(){return this.compressionMethod===8};function h(s,n){var v=s&31,x=(s>>5&15)-1,A=(s>>9&127)+1980,N=0,U=(n&31)*2,z=n>>5&63,k=n>>11&31;return new Date(A,x,v,k,z,U,N)}function E(s){return s.indexOf("\\")!==-1?"invalid characters in fileName: "+s:/^[a-zA-Z]:/.test(s)||/^\//.test(s)?"absolute path: "+s:s.split("/").indexOf("..")!==-1?"invalid relative path: "+s:null}function g(s,n,v,x,A,N){if(x===0)return setImmediate(function(){N(null,L(0))});s.read(n,v,x,A,function(U,z){if(U)return N(U);if(z<x)return N(new Error("unexpected EOF"));N()})}_.inherits(d,p);function d(s){p.call(this),this.actualByteCount=0,this.expectedByteCount=s}d.prototype._transform=function(s,n,v){if(this.actualByteCount+=s.length,this.actualByteCount>this.expectedByteCount){var x="too many bytes in the stream. expected "+this.expectedByteCount+". got at least "+this.actualByteCount;return v(new Error(x))}v(null,s)},d.prototype._flush=function(s){if(this.actualByteCount<this.expectedByteCount){var n="not enough bytes in the stream. expected "+this.expectedByteCount+". got only "+this.actualByteCount;return s(new Error(n))}s()},_.inherits(a,w);function a(){w.call(this),this.refCount=0}a.prototype.ref=function(){this.refCount+=1},a.prototype.unref=function(){var s=this;if(s.refCount-=1,s.refCount>0)return;if(s.refCount<0)throw new Error("invalid unref");s.close(n);function n(v){if(v)return s.emit("error",v);s.emit("close")}},a.prototype.createReadStream=function(s){var n=s.start,v=s.end;if(n===v){var x=new C;return setImmediate(function(){x.end()}),x}var A=this._readStreamForRange(n,v),N=!1,U=new m(this);A.on("error",function(k){setImmediate(function(){N||U.emit("error",k)})}),U.destroy=function(){A.unpipe(U),U.unref(),A.destroy()};var z=new d(v-n);return U.on("error",function(k){setImmediate(function(){N||z.emit("error",k)})}),z.destroy=function(){N=!0,U.unpipe(z),U.destroy()},A.pipe(U).pipe(z)},a.prototype._readStreamForRange=function(s,n){throw new Error("not implemented")},a.prototype.read=function(s,n,v,x,A){var N=this.createReadStream({start:x,end:x+v}),U=new D,z=0;U._write=function(k,$,q){k.copy(s,n+z,0,k.length),z+=k.length,q()},U.on("finish",A),N.on("error",function(k){A(k)}),N.pipe(U)},a.prototype.close=function(s){setImmediate(s)},_.inherits(m,C);function m(s){C.call(this),this.context=s,this.context.ref(),this.unreffedYet=!1}m.prototype._flush=function(s){this.unref(),s()},m.prototype.unref=function(s){this.unreffedYet||(this.unreffedYet=!0,this.context.unref())};var S="\0☺☻♥♦♣♠•◘○◙♂♀♪♫☼►◄↕‼¶§▬↨↑↓→←∟↔▲▼ !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~⌂ÇüéâäàåçêëèïîìÄÅÉæÆôöòûùÿÖÜ¢£¥₧ƒáíóúñÑªº¿⌐¬½¼¡«»░▒▓│┤╡╢╖╕╣║╗╝╜╛┐└┴┬├─┼╞╟╚╔╩╦╠═╬╧╨╤╥╙╘╒╓╫╪┘┌█▄▌▐▀αßΓπΣσµτΦΘΩδ∞φε∩≡±≥≤⌠⌡÷≈°∙·√ⁿ²■ ";function F(s,n,v,x){if(x)return s.toString("utf8",n,v);for(var A="",N=n;N<v;N++)A+=S[s[N]];return A}function O(s,n){var v=s.readUInt32LE(n),x=s.readUInt32LE(n+4);return x*4294967296+v}var L;typeof Buffer.allocUnsafe=="function"?L=function(s){return Buffer.allocUnsafe(s)}:L=function(s){return new Buffer(s)};function M(s){if(s)throw s}return ae}var Ve,At;function Mt(){if(At)return Ve;At=1;class c{constructor(I){this._buffer=I}open(){return Promise.resolve()}close(){return Promise.resolve()}read(I,t,_,w){return this._buffer.copy(I,t,w,w+_),Promise.resolve(I)}buffer(){return this._buffer}static isBufferReader(I){return I instanceof c}}return Ve=c,Ve}var Ge,Dt;function Bt(){if(Dt)return Ge;Dt=1;const c=se;class T{constructor(t){this._filename=t}open(){return new Promise((t,_)=>{c.open(this._filename,"r",438,(w,p)=>{if(w)return _(w);this._fd=p,t()})})}close(){return new Promise((t,_)=>{this._fd?c.close(this._fd,w=>{if(w)return _(w);delete this._fd,t()}):t()})}read(t,_,w,p){return new Promise((C,D)=>{if(!this._fd)return D(new Error("file not open"));c.read(this._fd,t,_,w,p,(i,y,r)=>{if(i)return D(i);C(r)})})}fd(){return this._fd}static isFileReader(t){return t instanceof T}}return Ge=T,Ge}var Ye,Lt;function _i(){if(Lt)return Ye;Lt=1;const c=se,T=fi(),I=pi(),t=Mt(),_=Bt(),w=Ot();function p(D,i,y){return y===i.length?Promise.resolve():Promise.resolve(D(i[y++])).then(()=>p(D,i,y))}class C{constructor(){this._streamTypes={"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml":!0,"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":!0,"application/vnd.openxmlformats-package.relationships+xml":!0},this._headerTypes={"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header":!0,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer":!0},this._actions={},this._defaults={}}shouldProcess(i){if(this._actions[i])return!0;const y=c.posix.extname(i).replace(/^\./,"");if(!y)return!1;const r=this._defaults[y];return!!(r&&this._streamTypes[r])}openArchive(i){if(t.isBufferReader(i))return new Promise((y,r)=>{I.fromBuffer(i.buffer(),{lazyEntries:!0},function(B,P){if(B)return r(B);y(P)})});if(_.isFileReader(i))return new Promise((y,r)=>{I.fromFd(i.fd(),{lazyEntries:!0,autoClose:!1},function(B,P){if(B)return r(B);y(P)})});throw new Error("Unexpected reader type: "+i.constructor.name)}processEntries(i){let y={},r=[];return new Promise((B,P)=>{i.readEntry(),i.on("error",P),i.on("entry",b=>{const u=b.fileName;y[u]=b,r.push(u),i.readEntry()}),i.on("end",()=>B(this._document))}).then(()=>{const B=r.indexOf("[Content_Types].xml");if(B===-1)throw new Error("Invalid Open Office XML: missing content types");return r.splice(B,1),r.unshift("[Content_Types].xml"),this._actions["[Content_Types].xml"]=!0,p(P=>{if(this.shouldProcess(P))return this.handleEntry(i,y[P])},r,0)})}extract(i){let y=this.openArchive(i);return this._document=new w,this._relationships={},this._entryTable={},this._entries=[],y.then(r=>this.processEntries(r)).then(()=>{let r=this._document;return r._textboxes&&r._textboxes.length>0&&(r._textboxes=r._textboxes+`
`),r._headerTextboxes&&r._headerTextboxes.length>0&&(r._headerTextboxes=r._headerTextboxes+`
`),r})}handleOpenTag(i){if(i.name==="Override"){const y=this._streamTypes[i.attributes.ContentType];if(y){const r=i.attributes.PartName.replace(/^[/]+/,""),B={action:y,type:i.attributes.ContentType};this._actions[r]=B}}else if(i.name==="Default"){const y=i.attributes.Extension,r=i.attributes.ContentType;this._defaults[y]=r}else if(i.name==="Relationship")this._relationships[i.attributes.Id]={type:i.attributes.Type,target:i.attributes.Target};else if(i.name==="w:document"||i.name==="w:footnotes"||i.name==="w:endnotes"||i.name==="w:comments")this._context=["content","body"],this._pieces=[];else if(i.name==="w:hdr"||i.name==="w:ftr")this._context=["content","header"],this._pieces=[];else if(i.name==="w:endnote"||i.name==="w:footnote"){const y=i.attributes["w:type"]||this._context[0];this._context.unshift(y)}else i.name==="w:tab"&&this._context[0]==="content"?this._pieces.push("	"):i.name==="w:br"&&this._context[0]==="content"?(i.attributes["w:type"]||"")==="page"?this._pieces.push(`
`):this._pieces.push(`
`):i.name==="w:del"||i.name==="w:instrText"?this._context.unshift("deleted"):i.name==="w:tabs"?this._context.unshift("tabs"):i.name==="w:tc"?this._context.unshift("cell"):i.name==="w:drawing"?this._context.unshift("drawing"):i.name==="w:txbxContent"&&(this._context.unshift(this._pieces),this._context.unshift("textbox"),this._pieces=[])}handleCloseTag(i){if(i.name==="w:document")this._context=null,this._document._body=this._pieces.join("");else if(i.name==="w:footnote"||i.name==="w:endnote")this._context.shift();else if(i.name==="w:footnotes")this._context=null,this._document._footnotes=this._pieces.join("");else if(i.name==="w:endnotes")this._context=null,this._document._endnotes=this._pieces.join("");else if(i.name==="w:comments")this._context=null,this._document._annotations=this._pieces.join("");else if(i.name==="w:hdr")this._context=null,this._document._headers=this._document._headers+this._pieces.join("");else if(i.name==="w:ftr")this._context=null,this._document._footers=this._document._footers+this._pieces.join("");else if(i.name==="w:p")(this._context[0]==="content"||this._context[0]==="cell"||this._context[0]==="textbox")&&this._pieces.push(`
`);else if(i.name==="w:del"||i.name==="w:instrText")this._context.shift();else if(i.name==="w:tabs")this._context.shift();else if(i.name==="w:tc")this._pieces.pop(),this._pieces.push("	"),this._context.shift();else if(i.name==="w:tr")this._pieces.push(`
`);else if(i.name==="w:drawing")this._context.shift();else if(i.name==="w:txbxContent"){const y=this._pieces.join("");if(this._context.shift()!=="textbox")throw new Error("Invalid textbox context");if(this._pieces=this._context.shift(),this._context[0]==="drawing"||y.length==0)return;const P=this._context.includes("header")?"_headerTextboxes":"_textboxes";this._document[P]?this._document[P]=this._document[P]+`
`+y:this._document[P]=y}}createXmlParser(){const i=new T.SaxesParser;return i.on("opentag",y=>{try{this.handleOpenTag(y)}catch(r){i.fail(r.message)}}),i.on("closetag",y=>{try{this.handleCloseTag(y)}catch(r){i.fail(r.message)}}),i.on("text",y=>{try{if(!this._context)return;(this._context[0]==="content"||this._context[0]==="cell"||this._context[0]==="textbox")&&this._pieces.push(y)}catch(r){i.fail(r.message)}}),i}handleEntry(i,y){return new Promise((r,B)=>{i.openReadStream(y,(P,b)=>{if(P)return B(P);this._source=y.fileName;const u=this.createXmlParser();u.on("error",l=>{b.destroy(l),B(l)}),u.on("end",()=>r()),b.on("end",()=>u.close()),b.on("error",l=>B(l)),b.on("readable",()=>{for(;;){const l=b.read(4096);if(l===null)return;u.write(l)}})})})}}return Ye=C,Ye}var Qe,It;function Ei(){if(It)return Qe;It=1;const{Buffer:c}=Rt(),T=ci(),I=_i(),t=Mt(),_=Bt();class w{constructor(){}extract(C){let D=null;c.isBuffer(C)?D=new t(C):typeof C=="string"&&(D=new _(C));const i=c.alloc(512);return D.open().then(()=>D.read(i,0,512,0)).then(y=>{let r=null;if(y.readUInt16BE(0)===53455)r=T;else if(y.readUInt16BE(0)===20555){const B=y.readUInt16BE(2);(B===772||B===1286||B===1800)&&(r=I)}if(!r)throw new Error("Unable to read this type of file");return new r().extract(D)}).finally(()=>D.close())}}return Qe=w,Qe}var Ut=Ei();const gi=ei(Ut),Si=ti({__proto__:null,default:gi},[Ut]);export{Si as w};
